# Chapter 21 클래스 메타프로그래밍

---

클래스 메타프로그래밍은 실행 도중에 클래스를 생성하거나 커스터마이즈하는 기술을 말한다.  

>메타클래스는 99%의 사용자가 신경써야 하는 것보다 훨씬 더 깊이 있는 마술이다.  
>필요한 것일까 하는 의문이 든다면, 여러분에게 메타클래스는 필요 없다.  
>-팀 피터스-

---

 **임포트 타임과 런타임**  
 메타프로그래밍에는 인터프리터가 언제 각 코드 블록을 평가하는지에 대해 아는 것이 중요하다.  
 '임포트 타임'과 '런타임'은 엄격히 정의되어 있는 것은 아니다.

import 문은 단지 단순한 선언이 아니며, 처음 임포트되는 모듈의 모든 최상위 수준 코드를   
실제 실행한다. 이후에 다시 임포트되는 경우에는 이름만 바인딩한다.  
import문이 각종 런타임의 동작을 유발하기 때문에 임포트 타임과 런타임의 구분이
모호해진다. 

---



**객체로서의 클래스**

>cls.\_\_bases\_\_: 슈퍼클래스들을 담은 튜플  
>cls.\_\_qualname\_\_: 전역 범위에서 클래스 정의를 담은 모듈까지의 경로를 점으로 구분한,   
클래스나 함수의 경로명을 담고 있는 파이썬 3.3에 추가된 속성.  
> cls.\_\_subclasses\_\_(): 이 메서드는 현재 메모리에 존재하는 클래스의   
바로 아래 서브클래스들의 리스트를 반환한다.   
> etc...


---  
## 21.6 메타클래스 __prepare__() 특별 메서드

몇몇 애플리케이션에서는 클래스의 속성이 정의되는 순서를 알아야 하는 경우가 종종 있다.   
지금까지 본 것처럼 type() 생성자와 메타클래스의 \_\_new\_\_() 및 \_\_init\_\_() 메서드는   
이름과 속성의 매핑으로 평가된 클래스 본체를 받는다. 그러나 기본적으로 매핑은 딕셔너리형이므로,   
메타클래스나 데커레이터가 확인할 수 있을 때는 클래스 본체 안에 등장하는 속성의 순서가 사라져버린다.  

이 문제를 해결하려면 파이썬 3에 소개된 \_\_prepare\_\_() 특별 메서드를 사용해야한다.   
이 특별 메서드는 메타 클래스에서만 의미가 있으며, 클래스 메서드여야한다.
